{{extend 'layout.html'}}
<head><link rel="stylesheet" href="{{=URL('static','css/profilePage.css')}}"></head>
<h1>"{{=current_user.first_name}} {{=current_user.last_name}}"</h1>
<h2>Gold: {{=current_user.gold}}</h2>
{{=form}}
<br>
<b>Inventory</b>
<table border="1">
  {{row = 0}}
  {{for item_id in current_user.inventory:}}
  {{  item = db.equip_items(item_id)}}
    {{if row%5 == 0:}}<tr>{{pass}}
    <td onclick=
	"jQuery('#display_name').text('{{=item.name}}'); 
	 jQuery('#display_type').text('{{=db.equip_types(item.category).name}}');
	 jQuery('#display_atk').text('{{=item.attack}}');
	 jQuery('#display_def').text('{{=item.defense}}');
	 jQuery('#display_spd').text('{{=item.speed}}');
	 jQuery('#display_flav').text('{{=item.details}}');"
	>{{=item.name}}</td>
    {{if row%5 == 4:}}</tr>{{pass}}
  {{row += 1}}
  {{pass}}
</table>

<table>
  <td><b>Name</b></td>
  <td><b>Type</b></td>
  <td><b>Attack</b></td>
  <td><b>Defense</b></td>
  <td><b>Speed</b></td>
  <tr>
    <td id="display_name"></td>
    <td id="display_type"></td>
    <td id="display_atk"></td>
    <td id="display_def"></td>
    <td id="display_spd"></td>
  </tr>
  <tr>
    <td colspan="4" id="display_flav"></td>
    <td id="equip_button" class='button'>{{=FORM(INPUT(_name='equip', _type='submit', _value='Equip'), _action=URL("profilePage", args=["equip",item_id]))}}</td>
  </tr>
</table>

<br>
<b>Current Loadout</b>
{{if current_user.curr_loadout:}}
<table border="1">
  <td><b>Slot</b></td><td><b>Name</b></td><td></td>
  {{loadout_list = db.loadouts(current_user.curr_loadout).equip_list}}
  {{for slot_id in range(1,7):}}
  {{  if loadout_list[slot_id]:}}
  {{    equip_item = db.equip_items(loadout_list[slot_id])}}
  <tr>
    {{=TD(db.equip_types(slot_id).name)}}
    {{=TD(equip_item.name)}}
    <td class='button'>
      {{=FORM(INPUT(_type="submit",_value="Unequip"),_action=URL("profilePage", args=["unequip",equip_item.id]))}}
    </td>
  </tr>
  {{  else:}}
  {{    =TR(db.equip_types(slot_id).name, "None")}}
  {{  pass}}
  {{pass}}
</table>
{{else:}}
  <br>Nothing Equipped
{{pass}}
